# Models Directory

Place your trained TensorFlow Lite model here.

## Required Files

- `poop_detector.tflite` - YOLOv8 model converted to TensorFlow Lite format
- `audio_calibration.json` - Motor baseline frequencies (generated by calibration)

## Getting a Model

### Option 1: Download Pre-trained Model

Download from the ScatSpotter dataset or other sources:

```bash
# Example: Download from your training server
wget https://your-server.com/models/poop_detector.tflite -O models/poop_detector.tflite
```

### Option 2: Train Your Own

1. Collect training data:
```bash
python -c "from vision.camera import CameraInterface; import yaml; \
  config = yaml.safe_load(open('config.yaml')); \
  cam = CameraInterface(config); \
  import os; os.makedirs('training_data/images', exist_ok=True); \
  [cam.capture_and_save(f'training_data/images/img_{i:04d}.jpg') for i in range(100)]; \
  cam.cleanup()"
```

2. Annotate images using [Roboflow](https://roboflow.com/) or [LabelImg](https://github.com/heartexlabs/labelImg)

3. Export annotations in YOLO format

4. Train model:
```bash
python scripts/train_model.py --data training_data/data.yaml --epochs 100
```

5. Convert to TensorFlow Lite:
```bash
python scripts/convert_to_tflite.py \
  --model runs/detect/poop_detector/weights/best.pt \
  --output models/poop_detector.tflite
```

## Model Requirements

- **Input**: RGB image, 416x416 pixels (or as specified in config.yaml)
- **Output**: Bounding boxes, confidence scores, class IDs
- **Format**: TensorFlow Lite (.tflite)
- **Quantization**: INT8 recommended for Raspberry Pi performance
- **Classes**: Single class "poop" (class_id: 0)

## Audio Calibration

The `audio_calibration.json` file is generated automatically by running:

```bash
python main.py --calibrate-audio
```

This records baseline frequency signatures for motor stall detection.

## File Structure

```
models/
├── README.md (this file)
├── poop_detector.tflite (your trained model)
└── audio_calibration.json (generated by calibration)
```

## Model Performance Targets

On Raspberry Pi 5:
- **Inference Speed**: 2-5 FPS (without Edge TPU)
- **Accuracy**: >85% mAP (with good training data)
- **Model Size**: <10 MB (INT8 quantized)

With Coral Edge TPU:
- **Inference Speed**: 20-30 FPS
- **Latency**: <50ms per frame

## Troubleshooting

### "Model not found" error
- Check file exists: `ls -lh models/poop_detector.tflite`
- Verify path in config.yaml matches actual file location

### Poor detection accuracy
- Collect more training data in your specific environment
- Include various lighting conditions
- Annotate carefully (tight bounding boxes)
- Train for more epochs (100-200)

### Slow inference
- Verify INT8 quantization was used
- Reduce input resolution in config.yaml
- Consider Coral Edge TPU accelerator

---

**Note**: This directory is listed in `.gitignore` - model files won't be committed to git due to size.
